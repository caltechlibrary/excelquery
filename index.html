<!DOCTYPE html>
<html>
<head>
    <title>Caltech Library's Digital Library Development Sandbox</title>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="/css/site.css">
</head>
<body>
<header>
<a href="http://library.caltech.edu"><img src="assets/liblogo.gif" alt="Caltech Library logo"></a>
</header>
<nav>
<ul>
<li><a href="/">Home</a></li>
<li><a href="./">README</a>
<!-- + [Web Version](webapp/) --></li>
<li><a href="install.html">INSTALL</a></li>
<li><a href="license.html">LICENSE</a></li>
<li><a href="https://github.com/caltechlibrary/exelquery">Github</a></li>
</ul>

</nav>

<section>
<h1>excelquery</h1>

<p><em>excelquery</em> is an experimental utility designed to update workbook files (.xlsx) taking a column as search query strings and
putting the results in another worksheet of the same workbook. This proof of concept works with EPrints repository
software relying on advanced search and results returned in RSS2 format. By default the search if performanced against
<a href="https://authors.library.caltech.edu">CaltechAUTHORS</a> repository. You can point at a different EPrints repository by
setting the environment variable <em>EPRINTS_SEARCH_URL</em>.</p>

<h2>USAGE</h2>

<pre><code class="language-shell">    excelquery [OPTIONS] WORKBOOK_NAME QUERY_SHEET_NAME QUERY_COLUMN [RESULT_SHEET_NAME]
</code></pre>

<p>The command line program <em>excelquery</em> takes the name of a xlsx file along with a sheet name (or number) and the column name
for the query string. A sheet name can optionally be supplied for results.  By default it searches on &ldquo;Sheet1&rdquo; and by
default a new sheet is created called &ldquo;Result&rdquo;. This can be changed with the &ldquo;-s&rdquo; and &ldquo;-r&rdquo; command line options.</p>

<p>The simple form where column <em>A</em> in *Sheet 1&rdquo; holds the query string and results will be put in a new sheet called &ldquo;Result&rdquo;</p>

<pre><code class="language-shell">    excelquery titlelist.xlsx &quot;Sheet 1&quot; A 
</code></pre>

<p><em>excelquery</em> will display console message describing the processing on stdout. If there are errors they will be sent to
stderr with catastrophic errors exiting with a value 1. If the program is successful it will exit with the value 0.</p>

<ul>
<li>The sheet name can be the textual number of the sheet or its index (the first sheet&rsquo;s index is zero)</li>
<li>Query column should correspond to the sheet you want to run through (e.g. &ldquo;Sheet1&rdquo;)</li>
<li>Column names are in Excel&rsquo;s letter format (e.g. &ldquo;A&rdquo;, &ldquo;FX&rdquo;, &ldquo;BBC&rdquo;).</li>
</ul>

<h2>OPTIONS</h2>

<ul>
<li>-h, -help   show help information</li>
<li>-l, -license    show license information</li>

<li><p>-v, -version    show version information</p></li>

<li><p>-s, -skip   set boolean for skipping first row of spreadsheet (default true)</p></li>
</ul>

<h2>Example</h2>

<pre><code class="language-shell">    excelquery ./testdata/demo2.xlsx &quot;Title List&quot; A
</code></pre>

<p>This opens demo2.xlsx and uses the sheet named &ldquo;Title List&rdquo;. It populates fresh results in in a new sheet called &ldquo;Result&rdquo; based on the
query string in column <em>A</em> of &ldquo;Title List&rdquo;. The results are taken from the item field of the RSS2
response to the search request.</p>

</section>

<footer>
<span><h1><A href="http://caltech.edu">Caltech</a></h1></span>
<span>&copy; 2015 - 2016 <a href="http://library.caltech.edu/CLS_Copyright.htm">Caltech library</a></span>
<address>1200 E California Blvd, Mail Code 1-32, Pasadena, CA 91125-3200</address> 
<span>Phone: <a href="tel:+1-626-395-3405">(626)395-3405</a></span>
<span><a href="mailto:library@caltech.edu">Email Us</a></span>
<a class="cl-hide" href="sitemap.xml">Site Map</a>
</footer>
</body>
</html>
